<!DOCTYPE html>
<html>
    <head>



<title>Discrete Math meets Cryptography | RSA Analysis</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<link rel="stylesheet" href="/QuantumCryptography/style.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">


</head>
    <body class="is-preload">
        <div id="page-wrapper">
<header id="header">
    <h1>A Study into RSA</h1>
    <nav id="nav">
        <ul>
            <li><a href="https://prisha247.github.io/QuantumCryptography/">Home</a></li>
            <li>
                <a href="#" class="icon solid fa-angle-down">Learn More</a>
                <ul><li><a href="/QuantumCryptography/rsamath/">RSA Math</a></li><li><a href="/QuantumCryptography/quantum/">Quantum Computing</a></li><li><a href="/QuantumCryptography/proofs/">Theorems and Proofs</a></li><li><a href="/QuantumCryptography/about/">About Us</a></li><li><a href="/QuantumCryptography/elements/">Elements</a></li><li>
                            <a href="#">Submenu</a>
                            <ul><li><a href="#">Option One</a></li><li><a href="#">Option Two</a></li><li><a href="#">Option Three</a></li><li><a href="#">Option Four</a></li></ul>
                        </li></ul>
            </li>
            
            
        </ul>
    </nav>
</header>
<section id="main" class="container ">
  <header>
    <h2>Discrete Math meets Cryptography</h2>
    
  </header>
  <div class="box">
    
    <div class="row">
  
  <header>
	<h3 id="math-behind-the-rsa-algorithm">Math Behind The RSA Algorithm</h3>
<p>RSA (Rivest, Shamir, and Adleman) Algorithm is a method of cryptography used to secure communication.
RSA involves a public key and private key. The public key can be known to everyone- it is used to encrypt messages. Messages encrypted using the public key can only be decrypted with the private key. The keys for the RSA algorithm are generated the following way:</p>
<p>Pick two prime numbers $p$ and $q$ and take their product ($N$). The numbers $p$ and $q$ are not released to the public.</p>
<p>Next, find $\phi(N)$  (see Totient Theorem) which is $(p-1) (q-1) = $<span class="p-1">$1$</span>$ \cdot $<span class="q-1">$6$</span>$ = $<span class="totient">$6$</span>.
Choose encryption number $e$ such that $1 &lt; e &lt; \phi(N)$ AND $e$ is a <a href="https://en.wikipedia.org/wiki/Coprime_integers">coprime</a> of $N$  (<span class="n">$14$</span>) and $\phi(N)$ $($<span class="totient">$6$</span>$)$
Choose decryption number $(d)$ such that $de\ (\bmod N) = 1$
The decryption key is $(d, N)$</p>
<p>Encryption Key: (5,14)</p>
<form action="#">
  <div class="row gtr-uniform">
    <div class="col-6 col-12-xsmall">
      Enter $p$
      <input type="text" name="Enter p" onchange="refreshAll()" id="rsa-p" value="2" placeholder="Enter p" />
    </div>
    <div class="col-6 col-12-xsmall">
      Enter $q$
      <input type="text" name="Enter q" onchange="refreshAll()" id="rsa-q" value="7" placeholder="Enter q" />
    </div>
  </div>
  <div class="row gtr-uniform">
    <div class="col-12 col-12-xsmall">
      Enter Encryption Text
      <input type="text" name="Enter Encrpytion Text" onchange="refreshAll()" id="rsa-t" value="B" placeholder="Encrpytion Text" />
    </div>
  </div>
</form>
<div id="error" color="red"></div>
<p>Here, $p$ is <span class="p">$2$</span> and $q$ is <span class="q">$7$</span>.
Additionally, the encryption text is &ldquo;<span class="tStr">B</span>&rdquo;.</p>
<p>The product ($N$) is $pq$, or <span class="n">$14$</span>.</p>
<p><span class="n">$14$</span> becomes the modulus in the encryption and decryption key, thus <span class="n">$14$</span> is released to the public.</p>
<p>Assign value to text. Let that value be <span class="t">$2$</span>.</p>
<p>Now $e$ equals <span class="e">$3$</span>.
$2^5$(mod14) = 32(mod14) = 4(mod14)</p>
<p>Now solve to get the encrypted text:
<span class="emod"></span>
<br>
Here&rsquo;s the value for $d$:
<span class="d"></span></p>
<p>4 is the encryption. Let 4 equal D.</p>
<p>Decryption: <span class="priv-key">$(11,14)$</span></p>
<p>Encryption received: <span class="enc"></span>
<br></p>
<p>Solve to decrypt the text using $d$: <span class="dmod">$4^{11}(mod14) = 4194304(mod14) = 2(mod14)$</span></p>
<p><span class="dec">$2$</span> is the decryption, which can be converted into <span class="decStr"></span>.</p>

</header>
  <header>
	<h3 id="how-can-factoring-break-the-algorithm">How Can Factoring Break the Algorithm?</h3>
<p>The security of cryptography relies on certain &ldquo;hard&rdquo; problems. These problems are calculations that are simple to do with the right cryptographic key, but extremely difficult to do without it. A &ldquo;hard&rdquo; problem should take the best computers available billions of years to solve; an &ldquo;easy&rdquo; problem is one that can be solved very quickly.</p>
<p>Trapdoor functions are based on multiplication - which is easy to perform in one direction but next to impossible in the other
E.g. it is relatively easy to know that 263 * 373 = 98,099. However, given 98,099, it is extremely difficult to figure out what two prime numbers were multiplied to produce that number. As the prime numbers get larger, it becomes even more difficult to factor.</p>
<p>RSA is currently an example of a “hard” problem, because it relies on integer factorization. A user starts with a message and performs arithmetic on it that involves multiplication by a very large number (hundreds of digits long). The only way to decode the message is to find the prime factors of the resulting product. The security of RSA encryption rests on the fact that there’s no fast way to identify the prime factors of very large numbers. If you’re not the intended recipient of a message — and if you therefore lack the right key to decode it — you could search for a thousand years with the best computers and still not find the right prime factors.</p>

</header>
  <header>
	<h3 id="future-steps">Future Steps</h3>
<p>The future of RSA is dependent on how efficiently one can factor to determine the prime numbers p and q explained above. Today&rsquo;s computers (classical computers) are not efficient enough to break the RSA algorithm in a timely manner. This is where quantum computing comes into play. Quantum computers have significantly greater speed than classical computers posing a danger to RSA and all data encrypted using RSA. Click on the Quantum Computing page to learn more!
</header>

</div>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/javascript">
  pEl = document.getElementById("rsa-p");
  qEl = document.getElementById("rsa-q");
  tEl = document.getElementById("rsa-t");
  p = 2;
  q = 7;

  function prime(n) {   
    // almost copied from https://www.geeksforgeeks.org/check-a-number-is-prime-or-not-using-javascript/         
    var i, flag = true;

    // Getting the value form text
    // field using DOM
    n = parseInt(n) || 0;
    if(n === 0) {
      return false;
    }
    for(i = 2; i <= n - 1; i++)
        if (n % i == 0) {
            flag = false;
            break;
        }

        // Check and display alert message
    if (flag == true)
        return true; // prime
    else
        return false; // not prime
  }
  function gcd(x, y) {
    if(x === 0 || y === 0) {
      return 0;
    }
    if(x === y) {
      return x;
    }
    if(x >= y) {
      return gcd(x-y, y);
    }
    return gcd(x, y-x);
  }
  function coprime(x, y) {
    return gcd(x, y) === 1;
  }
  function getE(N) {
    let i = 3;
    while (i < N) {
      if (coprime(i, N)) {
        return i;
      }
      i += 2;
    }
    return 0;
  }
  // http://umaranis.com/2018/07/12/calculate-modular-exponentiation-powermod-in-javascript-ap-n/
  // calculates   base^exponent % modulus
  function powerMod(base, exponent, modulus) {
      if (modulus === 1) return 0;
      var result = 1;
      base = base % modulus;
      while (exponent > 0) {
          if (exponent % 2 === 1)  //odd number
              result = (result * base) % modulus;
          exponent = exponent >> 1; //divide by 2
          base = (base * base) % modulus;
      }
      return result;
  }

  function str2int(stringInput) {
    let output = "";
    for (var i = 0; i < stringInput.length; i++) {
        output += stringInput[i].charCodeAt(0).toString(2);
    }
    return parseInt(output, '2');
  }
  function int2str(intInput) {
    let output = "";
    while (intInput > 0) {
      output = String.fromCharCode(intInput % 128) + output;
      intInput = Math.floor(intInput/128);
    }
    return output;
  }

  // https://stackoverflow.com/questions/23279208/calculate-d-from-n-e-p-q-in-rsa#23281286
  function getD(a, m) {
    // validate inputs
    [a, m] = [Number(a), Number(m)]
    if (Number.isNaN(a) || Number.isNaN(m)) {
      return NaN // invalid input
    }
    a = (a % m + m) % m
    if (!a || m < 2) {
      return NaN // invalid input
    }
    // find the gcd
    const s = []
    let b = m
    while(b) {
      [a, b] = [b, a % b]
      s.push({a, b})
    }
    if (a !== 1) {
      return NaN // inverse does not exists
    }
    // find the inverse
    let x = 1
    let y = 0
    for(let i = s.length - 2; i >= 0; --i) {
      [x, y] = [y,  x - y * Math.floor(s[i].a / s[i].b)]
    }
    return (y % m + m) % m
  }

  // for loop copied from https://stackoverflow.com/questions/22754315/for-loop-for-htmlcollection-elements

  function refreshAll() {
    if(validateP() && validateQ()) {
      document.getElementById("error").innerHTML = "";
      updatePQ();
      refreshText();
    } else {
      errorEl = document.getElementById("error");
      errorEl.innerHTML = "Error: Ensure that $p$ and $q$ are prime numbers less than 100000 <br /><br />";
      MathJax.Hub.Queue(["Typeset",MathJax.Hub,errorEl]);

      // updatePQ();
    }
  }
  function validateP() {
    testP = pEl.value;
    if(testP > 1 && testP < 100000 && prime(testP)) {
      p = testP;
      return true;
    } else {
      return false;
    }
  }

  function validateQ() {
    testQ = qEl.value;
    if(testQ > 1 && testQ < 100000 && prime(testQ)) {
      q = testQ;
      return true;
    } else {
      return false;
    }
  }

  function updatePQ() {

    // update p and q
    updateClass("p", p);
    updateClass("q", q);

    // update p and q
    updateClass("p-1", p-1);
    updateClass("q-1", q-1);

    // update n
    n = p * q;
    updateClass("n", n);

    // update totient
    totient = (p-1)*(q-1);
    updateClass("totient", totient);

    e = getE(n);
    updateClass("e", e);
    // update d https://stackoverflow.com/questions/23279208/calculate-d-from-n-e-p-q-in-rsa#23281286
  }

  function updateClass(className, expr, options) {
    var list = document.getElementsByClassName(className);
    for (var i = 0; i < list.length; i++) {
        updateEl(list[i], (options || "$") + expr + (options || "$"));
    }
  }

  function updateEl(el, expr) {
    el.innerHTML = expr;
    MathJax.Hub.Queue(["Typeset",MathJax.Hub,el]);
  }

  function refreshText() {
    // tStr = tEl.value;
    t = 4; //str2int(tStr);

    updateClass("tStr", tStr, "");
    updateClass("t", t);

    enc = powerMod(t, e, totient);
    console.log("" + t + "^" + e + "\\ (\\bmod " + totient + ") = " + enc);
    updateClass("emod",
      "" + t + "^{" + e + "}\\ (\\bmod " + n + ") = " + enc
    );
    updateClass("enc", enc);

    d = getD(e, totient);
    updateClass("d", d);

    updateClass("priv-key", "(" + d + "," + n + ")");
    dec = powerMod(enc, d, totient);
    updateClass("dmod",
      "" + t + "^{" + d + "}\\ (\\bmod " + n + ") = " + dec
    );
    updateClass("dec", dec)

    decStr = int2str(dec);
    updateClass("decStr", decStr, "");
  }

  pEl.value = 2;
  qEl.value = 7;
  validateP() && validateQ() && refreshAll();
</script>

    


  </div>
  

            </section>
<footer id="footer">
    <ul class="icons">
        
    </ul>
    <ul class="copyright">
        
        <li>© Untitled. All rights reserved.</li>
        
        
        <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
        
        
        <li>Hugo Port: <a href="https://nelsonroberto.com/">Nelson/Roberto</a></li>
        
    </ul>
</footer>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']]
    }
});
</script>

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></div>
<script src="https://prisha247.github.io/QuantumCryptography/js/jquery.min.js"></script>
<script src="https://prisha247.github.io/QuantumCryptography/js/jquery.dropotron.min.js"></script>
<script src="https://prisha247.github.io/QuantumCryptography/js/jquery.scrollex.min.js"></script>
<script src="https://prisha247.github.io/QuantumCryptography/js/browser.min.js"></script>
<script src="https://prisha247.github.io/QuantumCryptography/js/breakpoints.min.js"></script>
<script src="https://prisha247.github.io/QuantumCryptography/js/util.js"></script>
<script src="https://prisha247.github.io/QuantumCryptography/js/main.js"></script></body>
</html>